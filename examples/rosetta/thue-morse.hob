// @test: thueMorse(6)
flipBits xs = [if (x == 0) then 1 else 0 | x <- xs]
thueMorse n = if (n == 0) then [0] else let prev = thueMorse(n - 1) in prev ++ flipBits(prev)
